# å…¨ç½‘éƒ½åœ¨æ±‚çš„ã€Œèš‚èšå‘€å˜¿ã€æ•™ç¨‹--åŸºäºPaddleGANçš„First order motion modelå®ç°

ä»€ä¹ˆï¼Ÿä½ è¿˜ä¸çŸ¥é“ã€Œèš‚èšå‘€å˜¿ã€ï¼Ÿè¿™ä½å…„å°ï¼Œé‚£ä½ å¯èƒ½outå¾—ç›¸å½“ä¸¥é‡ï¼

è¿™æ˜¯å¼•èµ·ç”·å¥³è€å°‘çš„äº‰ç›¸å…³æ³¨ã€ç«çˆ†ğŸ”¥æŠ–éŸ³ã€Bç«™ã€å…¨ç½‘éƒ½åœ¨æ±‚æ•™ç¨‹çš„ã€Œèš‚èšå‘€å˜¿ã€é­”æ³•ï¼
è€Œè¿™ç§˜å¯†å°±è—åœ¨[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)é£æ¡¨ç”Ÿæˆå¯¹æŠ—ç½‘ç»œå¥—ä»¶ä¸­ï¼
![](https://ai-studio-static-online.cdn.bcebos.com/4953c1e357e348669b919201c995c51c267a2f6db35b465080ebbddbd1b191b2)

æœ¬æ•™ç¨‹æ˜¯åŸºäº[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)å®ç°çš„First Order Motion model, å®ç°è®©ä»»ä½•äººå”±èµ·ã€Œèš‚èšå‘€å˜¿ã€çš„æ—‹å¾‹,è‹¥æ˜¯å¤§å®¶å–œæ¬¢è¿™ä¸ªæ•™ç¨‹ï¼Œè¯·åˆ°[Github PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)ä¸»é¡µç‚¹å‡»starå‘€ï¼ä¸‹é¢å°±è®©æˆ‘ä»¬ä¸€èµ·åŠ¨æ‰‹å®ç°å§ï¼

æ•´ä½“å®ç°åªæœ‰ä¸‰æ­¥ï¼š
1. ä¸‹è½½PaddleGANä»£ç 
2. è¿è¡ŒFirst Order Motion modelçš„å‘½ä»¤
3. ç»™è§†é¢‘åŠ ä¸Šå£°éŸ³

çœ‹~~ æ˜¯ä¸æ˜¯ç›¸å½“ç®€å•ï¼ï¼æ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¸€æ­¥æ­¥å¼€å§‹å§ï¼


## First Order Motion modelåŸç†
First Order Motion modelçš„ä»»åŠ¡æ˜¯image animationï¼Œç»™å®šä¸€å¼ æºå›¾ç‰‡ï¼Œç»™å®šä¸€ä¸ªé©±åŠ¨è§†é¢‘ï¼Œç”Ÿæˆä¸€æ®µè§†é¢‘ï¼Œå…¶ä¸­ä¸»è§’æ˜¯æºå›¾ç‰‡ï¼ŒåŠ¨ä½œæ˜¯é©±åŠ¨è§†é¢‘ä¸­çš„åŠ¨ä½œï¼Œæºå›¾åƒé€šå¸¸åŒ…å«ä¸€ä¸ªä¸»ä½“ï¼Œé©±åŠ¨è§†é¢‘åŒ…å«ä¸€ç³»åˆ—åŠ¨ä½œã€‚

é€šä¿—æ¥è¯´ï¼ŒFirst Order Motionèƒ½å¤Ÿå°†ç»™å®šçš„é©±åŠ¨è§†é¢‘ä¸­çš„äººç‰©Açš„åŠ¨ä½œè¿ç§»è‡³ç»™å®šçš„æºå›¾ç‰‡ä¸­çš„äººç‰©Bèº«ä¸Šï¼Œç”Ÿæˆå…¨æ–°çš„ä»¥äººç‰©Bçš„è„¸æ¼”ç»äººç‰©Açš„è¡¨æƒ…çš„è§†é¢‘ã€‚

ä»¥äººè„¸è¡¨æƒ…è¿ç§»ä¸ºä¾‹ï¼Œç»™å®šä¸€ä¸ªæºäººç‰©ï¼Œç»™å®šä¸€ä¸ªé©±åŠ¨è§†é¢‘ï¼Œå¯ä»¥ç”Ÿæˆä¸€ä¸ªè§†é¢‘ï¼Œå…¶ä¸­ä¸»ä½“æ˜¯æºäººç‰©ï¼Œè§†é¢‘ä¸­æºäººç‰©çš„è¡¨æƒ…æ˜¯ç”±é©±åŠ¨è§†é¢‘ä¸­çš„è¡¨æƒ…æ‰€ç¡®å®šçš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æºäººç‰©è¿›è¡Œäººè„¸å…³é”®ç‚¹æ ‡æ³¨ã€è¿›è¡Œè¡¨æƒ…è¿ç§»çš„æ¨¡å‹è®­ç»ƒã€‚

ä½†æ˜¯è¿™ç¯‡æ–‡ç« æå‡ºçš„æ–¹æ³•åªéœ€è¦åœ¨åŒç±»åˆ«ç‰©ä½“çš„æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒå³å¯ï¼Œæ¯”å¦‚å®ç°å¤ªæåŠ¨ä½œè¿ç§»å°±ç”¨å¤ªæè§†é¢‘æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œæƒ³è¦è¾¾åˆ°è¡¨æƒ…è¿ç§»çš„æ•ˆæœå°±ä½¿ç”¨äººè„¸è§†é¢‘æ•°æ®é›†voxcelebè¿›è¡Œè®­ç»ƒã€‚è®­ç»ƒå¥½åï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹åº”çš„é¢„è®­ç»ƒæ¨¡å‹å°±å¯ä»¥è¾¾åˆ°å‰è¨€ä¸­å®æ—¶image animationçš„æ“ä½œã€‚

## ä¸‹è½½PaddleGANä»£ç 


```python
# ä»githubä¸Šå…‹éš†PaddleGANä»£ç 
!git clone https://gitee.com/paddlepaddle/PaddleGAN
```

    fatal: destination path 'PaddleGAN' already exists and is not an empty directory.



```python
# å®‰è£…æ‰€éœ€å®‰è£…åŒ…
%cd PaddleGAN/
!pip install -r requirements.txt
!pip install imageio-ffmpeg
%cd applications/
```

    /home/aistudio/PaddleGAN
    Looking in indexes: https://mirror.baidu.com/pypi/simple/
    Requirement already satisfied: tqdm in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 1)) (4.36.1)
    Requirement already satisfied: PyYAML>=5.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 2)) (5.1.2)
    Collecting scikit-image>=0.14.0 (from -r requirements.txt (line 3))
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/fe/01/3a830f3df578ea3ed94ee7fd9f91e85c3dec2431d8548ab1c91869e51450/scikit_image-0.18.1-cp37-cp37m-manylinux1_x86_64.whl (29.2MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29.2MB 6.3MB/s eta 0:00:012
    [?25hRequirement already satisfied: scipy>=1.1.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 4)) (1.3.0)
    Requirement already satisfied: opencv-python in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 5)) (4.1.1.26)
    Requirement already satisfied: imageio-ffmpeg in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 6)) (0.3.0)
    Collecting librosa==0.7.0 (from -r requirements.txt (line 7))
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/ad/6e/0eb0de1c9c4e02df0b40e56f258eb79bd957be79b918511a184268e01720/librosa-0.7.0.tar.gz (1.6MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.6MB 26.5MB/s eta 0:00:01
    [?25hRequirement already satisfied: numba==0.48 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 8)) (0.48.0)
    Requirement already satisfied: easydict in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from -r requirements.txt (line 9)) (1.9)
    Collecting PyWavelets>=1.1.1 (from scikit-image>=0.14.0->-r requirements.txt (line 3))
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/62/bd/592c7242fdd1218a96431512e77265c50812315ef72570ace85e1cfae298/PyWavelets-1.1.1-cp37-cp37m-manylinux1_x86_64.whl (4.4MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.4MB 16.0MB/s eta 0:00:01
    [?25hCollecting numpy>=1.16.5 (from scikit-image>=0.14.0->-r requirements.txt (line 3))
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/73/ef/8967d406f3f85018ceb5efab50431e901683188f1741ceb053efcab26c87/numpy-1.20.2-cp37-cp37m-manylinux2010_x86_64.whl (15.3MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.3MB 8.3MB/s eta 0:00:011
    [?25hRequirement already satisfied: pillow!=7.1.0,!=7.1.1,>=4.3.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-image>=0.14.0->-r requirements.txt (line 3)) (7.1.2)
    Requirement already satisfied: matplotlib!=3.0.0,>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-image>=0.14.0->-r requirements.txt (line 3)) (2.2.3)
    Requirement already satisfied: networkx>=2.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-image>=0.14.0->-r requirements.txt (line 3)) (2.4)
    Requirement already satisfied: imageio>=2.3.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-image>=0.14.0->-r requirements.txt (line 3)) (2.6.1)
    Collecting tifffile>=2019.7.26 (from scikit-image>=0.14.0->-r requirements.txt (line 3))
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/c0/9b/db2b4777156c755ea589cb93ae50fc12a39119623bd7eca9bb8eaab523fc/tifffile-2021.4.8-py3-none-any.whl (165kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 174kB 32.5MB/s eta 0:00:01
    [?25hRequirement already satisfied: audioread>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (2.1.8)
    Requirement already satisfied: scikit-learn!=0.19.0,>=0.14.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (0.22.1)
    Requirement already satisfied: joblib>=0.12 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (0.14.1)
    Requirement already satisfied: decorator>=3.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (4.4.0)
    Requirement already satisfied: six>=1.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (1.15.0)
    Requirement already satisfied: resampy>=0.2.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (0.2.2)
    Requirement already satisfied: soundfile>=0.9.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from librosa==0.7.0->-r requirements.txt (line 7)) (0.10.3.post1)
    Requirement already satisfied: setuptools in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from numba==0.48->-r requirements.txt (line 8)) (41.4.0)
    Requirement already satisfied: llvmlite<0.32.0,>=0.31.0dev0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from numba==0.48->-r requirements.txt (line 8)) (0.31.0)
    Requirement already satisfied: pytz in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib!=3.0.0,>=2.0.0->scikit-image>=0.14.0->-r requirements.txt (line 3)) (2019.3)
    Requirement already satisfied: python-dateutil>=2.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib!=3.0.0,>=2.0.0->scikit-image>=0.14.0->-r requirements.txt (line 3)) (2.8.0)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib!=3.0.0,>=2.0.0->scikit-image>=0.14.0->-r requirements.txt (line 3)) (2.4.2)
    Requirement already satisfied: cycler>=0.10 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib!=3.0.0,>=2.0.0->scikit-image>=0.14.0->-r requirements.txt (line 3)) (0.10.0)
    Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib!=3.0.0,>=2.0.0->scikit-image>=0.14.0->-r requirements.txt (line 3)) (1.1.0)
    Requirement already satisfied: cffi>=1.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from soundfile>=0.9.0->librosa==0.7.0->-r requirements.txt (line 7)) (1.14.0)
    Requirement already satisfied: pycparser in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from cffi>=1.0->soundfile>=0.9.0->librosa==0.7.0->-r requirements.txt (line 7)) (2.19)
    Building wheels for collected packages: librosa
      Building wheel for librosa (setup.py) ... [?25ldone
    [?25h  Created wheel for librosa: filename=librosa-0.7.0-cp37-none-any.whl size=1598346 sha256=42d008d72d0138c1ea9ab3c1cbbaa2fae171f5e2135ac0a4311d49dea4e60d4a
      Stored in directory: /home/aistudio/.cache/pip/wheels/81/7e/60/c27574fffbf2f28075dbf4b28c00d3fe3240fefb51d597932e
    Successfully built librosa
    [31mERROR: blackhole 0.3.2 has requirement xgboost==1.1.0, but you'll have xgboost 1.3.3 which is incompatible.[0m
    Installing collected packages: numpy, PyWavelets, tifffile, scikit-image, librosa
      Found existing installation: numpy 1.16.4
        Uninstalling numpy-1.16.4:
          Successfully uninstalled numpy-1.16.4
      Found existing installation: librosa 0.7.2
        Uninstalling librosa-0.7.2:
          Successfully uninstalled librosa-0.7.2
    Successfully installed PyWavelets-1.1.1 librosa-0.7.0 numpy-1.20.2 scikit-image-0.18.1 tifffile-2021.4.8
    Looking in indexes: https://mirror.baidu.com/pypi/simple/
    Requirement already satisfied: imageio-ffmpeg in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (0.3.0)
    /home/aistudio/PaddleGAN/applications



```python
%cd ~
!mkdir output
```

    /home/aistudio
    mkdir: cannot create directory â€˜outputâ€™: File exists


## æ‰§è¡Œå‘½ä»¤
å¤§å®¶å¯ä»¥ä¸Šä¼ è‡ªå·±å‡†å¤‡çš„è§†é¢‘å’Œå›¾ç‰‡ï¼Œå¹¶åœ¨å¦‚ä¸‹å‘½ä»¤ä¸­çš„source_imageå‚æ•°å’Œdriving_videoå‚æ•°åˆ†åˆ«æ¢æˆè‡ªå·±çš„å›¾ç‰‡å’Œè§†é¢‘è·¯å¾„ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°±å¯ä»¥å®ŒæˆåŠ¨ä½œè¡¨æƒ…è¿ç§»ï¼Œç¨‹åºè¿è¡ŒæˆåŠŸåï¼Œä¼šåœ¨ouputæ–‡ä»¶å¤¹ç”Ÿæˆåä¸ºresult.mp4çš„è§†é¢‘æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å³ä¸ºåŠ¨ä½œè¿ç§»åçš„è§†é¢‘ã€‚æœ¬é¡¹ç›®ä¸­æä¾›äº†åŸå§‹å›¾ç‰‡å’Œé©±åŠ¨è§†é¢‘ä¾›å±•ç¤ºä½¿ç”¨ã€‚å…·ä½“çš„å„å‚æ•°ä½¿ç”¨è¯´æ˜å¦‚ä¸‹
- driving_video: é©±åŠ¨è§†é¢‘ï¼Œè§†é¢‘ä¸­äººç‰©çš„è¡¨æƒ…åŠ¨ä½œä½œä¸ºå¾…è¿ç§»çš„å¯¹è±¡
- source_image: åŸå§‹å›¾ç‰‡ï¼Œè§†é¢‘ä¸­äººç‰©çš„è¡¨æƒ…åŠ¨ä½œå°†è¿ç§»åˆ°è¯¥åŸå§‹å›¾ç‰‡ä¸­çš„äººç‰©ä¸Š
- relative: æŒ‡ç¤ºç¨‹åºä¸­ä½¿ç”¨è§†é¢‘å’Œå›¾ç‰‡ä¸­äººç‰©å…³é”®ç‚¹çš„ç›¸å¯¹åæ ‡è¿˜æ˜¯ç»å¯¹åæ ‡ï¼Œå»ºè®®ä½¿ç”¨ç›¸å¯¹åæ ‡ï¼Œè‹¥ä½¿ç”¨ç»å¯¹åæ ‡ï¼Œä¼šå¯¼è‡´è¿ç§»åäººç‰©æ‰­æ›²å˜å½¢
- adapt_scale: æ ¹æ®å…³é”®ç‚¹å‡¸åŒ…è‡ªé€‚åº”è¿åŠ¨å°ºåº¦



```python
!pip install  -q paddlehub
```


```python
!hub install deeplabv3p_xception65_humanseg==1.1.2
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
      import imp
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:26: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      def convert_to_list(value, n, name, dtype=np.int):
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/__init__.py:107: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import MutableMapping
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/rcsetup.py:20: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Iterable, Mapping
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:53: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Sized
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/scipy/special/orthogonal.py:81: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      from numpy import (exp, inf, pi, sqrt, floor, sin, cos, around, int,
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/scipy/linalg/__init__.py:217: DeprecationWarning: The module numpy.dual is deprecated.  Instead of using dual, use the functions directly from numpy or scipy.
      from numpy.dual import register_func
    2021-04-17 02:25:26,969 - INFO - Lock 140654541912656 acquired on /home/aistudio/.paddlehub/tmp/deeplabv3p_xception65_humanseg
    [INFO 2021-04-17 02:25:26,969 filelock.py:274] Lock 140654541912656 acquired on /home/aistudio/.paddlehub/tmp/deeplabv3p_xception65_humanseg
    Download https://bj.bcebos.com/paddlehub/paddlehub_dev/deeplabv3p_xception65_humanseg.tar.gz
    [##################################################] 100.00%
    Decompress /home/aistudio/.paddlehub/tmp/tmpcd6ruxid/deeplabv3p_xception65_humanseg.tar.gz
    [##################################################] 100.00%
    [32m[2021-04-17 02:25:32,553] [    INFO][0m - Successfully installed deeplabv3p_xception65_humanseg-1.1.2[0m
    2021-04-17 02:25:32,710 - INFO - Lock 140654541912656 released on /home/aistudio/.paddlehub/tmp/deeplabv3p_xception65_humanseg
    [INFO 2021-04-17 02:25:32,710 filelock.py:318] Lock 140654541912656 released on /home/aistudio/.paddlehub/tmp/deeplabv3p_xception65_humanseg
    [0m


```python
# !hub run deeplabv3p_xception65_humanseg --input_path "work/ç¾¤ä¸»ç…§ç‰‡3.jpg"
# !python -u infer.py --example HumanSeg --use_gpu
import paddlehub as hub
import cv2

human_seg = hub.Module(name="deeplabv3p_xception65_humanseg")
result = human_seg.segmentation(images=[cv2.imread('work/ç¾¤ä¸»ç…§ç‰‡3.jpg')],visualization=True,output_dir='humanseg_server_output')
```

    [2021-04-17 02:38:37,405] [ WARNING] - The _initialize method in HubModule will soon be deprecated, you can use the __init__() to handle the initialization of the object



```python
!export PYTHONPATH=$PYTHONPATH:/home/aistudio/PaddleGAN && python -u PaddleGAN/applications/tools/first-order-demo.py  --driving_video ~/work/fullbody.MP4  --source_image ~/work/3.png --relative --adapt_scale
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
      import imp
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:26: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      def convert_to_list(value, n, name, dtype=np.int):
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/scipy/linalg/__init__.py:217: DeprecationWarning: The module numpy.dual is deprecated.  Instead of using dual, use the functions directly from numpy or scipy.
      from numpy.dual import register_func
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/scipy/special/orthogonal.py:81: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      from numpy import (exp, inf, pi, sqrt, floor, sin, cos, around, int,
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/scipy/io/matlab/mio5.py:98: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      from .mio5_utils import VarReader5
    [04/17 21:12:08] ppgan INFO: Found /home/aistudio/.cache/ppgan/vox-cpk.pdparams
      2%|â–Š                                          | 4/222 [00:14<13:27,  3.71s/it]

## ä½¿ç”¨moviepyä¸ºç”Ÿæˆçš„è§†é¢‘åŠ ä¸ŠéŸ³ä¹


```python
# add audio
!pip install -q moviepy
```


```python
#ä¸ºç”Ÿæˆçš„è§†é¢‘åŠ ä¸ŠéŸ³ä¹
from moviepy.editor import *

videoclip_1 = VideoFileClip("/home/aistudio/work/fullbody.MP4")
videoclip_2 = VideoFileClip("./output/result.mp4")

audio_1 = videoclip_1.audio

videoclip_3 = videoclip_2.set_audio(audio_1)

videoclip_3.write_videofile("./output/qunzhu.mp4", audio_codec="aac")
```


```python
#æ˜¾ç¤ºå½“å‰è·¯å¾„
!pwd pwd

```

# åˆ°è¿™é‡Œï¼Œèš‚èšå‘€å˜¿çš„åˆ¶ä½œå°±å®Œæˆå•¦ï¼ï¼

è‡³æ­¤ï¼Œæœ¬é¡¹ç›®å¸¦å¤§å®¶ä½“éªŒäº†ä½¿ç”¨[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)å®Œæˆ**äººè„¸è¡¨æƒ…è¿ç§»**çš„æŠ€æœ¯è¿ç”¨ï¼Œæ¬¢è¿å¤§å®¶å°è¯•æœ¬é¡¹ç›®è¿›è¡Œä¸åŒç±»å‹çš„è§†é¢‘ä¿®å¤~ 

å½“ç„¶ï¼Œ[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)çš„åº”ç”¨ä¹Ÿä¸ä¼šæ­¢æ­¥äºæ­¤ï¼Œ[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)è¿˜èƒ½æä¾›å„ç±»ä¸åŒçš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬**å”‡å½¢åˆæˆï¼ˆå¯¹å˜´å‹ï¼‰ã€è§†é¢‘/ç…§ç‰‡ä¿®å¤ï¼ˆä¸Šè‰²ã€è¶…åˆ†ã€æ’å¸§ï¼‰ã€äººè„¸åŠ¨æ¼«åŒ–ã€ç…§ç‰‡åŠ¨æ¼«åŒ–**ç­‰ç­‰ï¼ï¼ä¸€ä¸ªæ¯”ä¸€ä¸ªæ›´å‰å®³ï¼

å¼ºçƒˆé¼“åŠ±å¤§å®¶ç©èµ·æ¥ï¼Œæ¿€å‘[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)çš„æ½œèƒ½ï¼

è®°å¾—ç‚¹ä¸ªStaræ”¶è—å™¢~~
